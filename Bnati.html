<form id="form">
  <input type="text" name="name" placeholder="الاسم" required>
  <input type="text" name="phone" placeholder="رقم الهاتف" required>
  <button type="submit">إرسال</button>
</form>

<div id="status">...</div>

<script>
const form = document.getElementById('form');
const statusDiv = document.getElementById('status');

form.onsubmit = function(e) {
  e.preventDefault();

  const name = form.name.value;
  const phone = form.phone.value;

  fetch("https://script.google.com/macros/s/AKfycbwlU6x6-bVEiCZ4ttDTaCtypfa51uGBCat4pFZWODz_s9_Dr_9s3kcH6GWxGjgjyktV/exec", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ name, phone })
  })
  .then(res => res.text())
  .then(result => {
    statusDiv.innerText = result;

    // تحقق كل 5 ثواني من حالة القبول
    setInterval(() => {
      fetch(`https://script.google.com/macros/s/AKfycbwlU6x6-bVEiCZ4ttDTaCtypfa51uGBCat4pFZWODz_s9_Dr_9s3kcH6GWxGjgjyktV/exec?key=${phone}`)
        .then(res => res.text())
        .then(status => {
          if (status === "تم القبول") {
            statusDiv.innerText = "🎉 تم قبولك!";
          } else {
            statusDiv.innerText = "⏳ قيد المراجعة...";
          }
        });
    }, 5000);
  })
  .catch(err => {
    statusDiv.innerText = "❌ فشل في الإرسال: " + err;
  });
}
</script>