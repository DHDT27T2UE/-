<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>منتج</title>
  <style>
    body {
      font-family: 'Cairo', sans-serif;
      direction: rtl;
      padding: 20px;
    }
    .product {
      background: #f8f8f8;
      border-radius: 10px;
      padding: 15px;
      text-align: center;
    }
    .btn {
      background-color: #222;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      text-decoration: none;
      display: inline-block;
      margin: 10px 5px;
      cursor: pointer;
    }
    .btn-whatsapp {
      background-color: #00963E;
    }
    .order-popup {
      display: none;
      position: fixed;
      top: 0; right: 0; left: 0; bottom: 0;
      background-color: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
      z-index: 999;
    }
    .order-popup.open {
      display: flex;
    }
    .order-content {
      background-color: white;
      padding: 20px;
      border-radius: 10px;
      width: 300px;
      text-align: right;
    }
    input, select {
      width: 100%;
      margin: 5px 0 15px;
      padding: 8px;
    }
  </style>
</head>
<body>

<div class="product">
  <img src="https://i.postimg.cc/prDdq0jc/0005181.jpg" width="200" />
  <h2>فستان بنفسجي فاخر</h2>
  <p>السعر: 200 ريال</p>
  <div class="buttons">
    <a class="btn buy" href="#" data-title="فستان بنفسجي فاخر">شراء</a>
  </div>
</div>

<div id="orderForm" class="order-popup">
  <div class="order-content">
    <h3>طلب المنتج</h3>
    <label>الاسم:</label>
    <input type="text" id="customerName" placeholder="اكتب اسمك">
    <label>المحافظة:</label>
    <input type="text" id="customerLocation" placeholder="مثلاً: صنعاء">
    <label>العنوان:</label>
    <input type="text" id="customerPhone" placeholder="الشارع أو أقرب معلم">
    <label>طريقة الدفع:</label>
    <select id="paymentMethod">
      <option value="كاش عند الاستلام">كاش عند الاستلام</option>
      <option value="تحويل بنكي">تحويل بنكي</option>
    </select>
    <div style="text-align: center;">
      <button class="btn btn-whatsapp" onclick="sendOrder()">إرسال عبر واتساب</button>
      <button class="btn" onclick="closeForm()">إلغاء</button>
    </div>
  </div>
</div>

<script>
  // فتح نموذج الطلب مع حفظ اسم المنتج
  function openForm(productTitle = "") {
    document.getElementById("orderForm").classList.add("open");
    window.currentProductTitle = productTitle;
    console.log("تم اختيار المنتج:", productTitle);
  }

  // اغلاق النموذج
  function closeForm() {
    document.getElementById("orderForm").classList.remove("open");
  }

  // عند تحميل الصفحة، نربط جميع أزرار الشراء بالحدث
  document.addEventListener("DOMContentLoaded", function() {
    const buyButtons = document.querySelectorAll('.btn.buy');
    buyButtons.forEach(button => {
      button.addEventListener('click', function(e) {
        e.preventDefault(); // لمنع الرابط الافتراضي
        const productTitle = this.getAttribute('data-title');
        openForm(productTitle);
      });
    });
  });

  function sendOrder() {
    const name = document.getElementById("customerName").value;
    const phone = document.getElementById("customerPhone").value;
    const location = document.getElementById("customerLocation").value;
    const payment = document.getElementById("paymentMethod").value;
    const product = window.currentProductTitle || "منتج";

    const message = `طلب منتج:\nالمنتج: ${product}\nالاسم: ${name}\nالمحافظة: ${location}\nالعنوان: ${phone}\nطريقة الدفع: ${payment}`;

    // استخدم رابط واتساب بصيغة whatsapp://send
    const url = `whatsapp://send?phone=+967776849791&text=${encodeURIComponent(message)}`;

    if (window.AppInventor) {
      window.AppInventor.setWebViewString(url);
    } else {
      alert("AppInventor غير متوفر");
    }
    closeForm();
  }
</script>

</body>
</html>